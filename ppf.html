<!Doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Протокольный фреймворк Photon Protocol Framework (PPF)</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
</head>
<body>

<div class="container">

<h1>Протокольный фреймворк Photon Protocol Framework (PPF)</h1>
<p>
    Проект протокольного фреймворка, призванного упростить и упорядочить организацию и проектирование пакетов
    протоколов и их взаимодействия между собой.

<h2>Задачи решаемые фреймворком</h2>
<ul>
    <li>
        Масштабируемость заложенных в пакеты протоколов полей. Сложно заранее предсказать величину значений допустимых
        к использованию в полях пакетов (см. IPv4 фейл). И в то же время требуется обеспечить минимальные накладные
        расходы при использовании в управляемых ограниченных по размеру сетях.
    <li>
        Обеспечение обратной совместимости по умолчанию. Все пакеты должны проектироваться с возможностью расширения
        и эволюционного развития. Должна быть исключена возможность получить форматы пакетов, которые не поддаются расширению.
</ul>

<h2>Базовый формат пакета PPF</h2>
<p>
    При описании базовых данных пакета используется единственный формат данных BER, который позволяет кодировать значение от 0 до 2^(2^8).
    На практике значение на данный момент ограниченно max(Uint64).
    Старший бит первого байта кодирует вид формата: если он равен 0, то оставшиеся 7 бит кодируют непосредственно значение,
    если он равен 1, то оставшиеся 7 бит кодируют длину значения в байтах, а затем идет непосредственно само значение.
    Каноническим представление значения является самое компактное представление где старший бит первого байта сброшен,
    то есть из трех возможных представлений числа 0 как 0b0000 0000.
    Неканонические варианты представления значения запрещены к использованию.

<p>Любой пакет имеет следующий формат:
<table class="table">
    <thead>
        <tr>
            <th>Имя поля
            <th>Наличие
            <th>Тип данных
            <th>Назначение
    </thead>
    <tbody>
        <tr>
            <td>Свойства пакета
            <td>обязательное
            <td>BER
            <td>Краткий перечень свойств пакета. См. раздел "Свойства пакета"
        <tr>
            <td>Данные свойств пакета
            <td>опциональное
            <td>Определяется стандартом PPF для каждого свойства
            <td>Содержит значения свойств пакета в соответствие со стандартом. См. раздел "Свойства пакета"
        <tr>
            <td>Данные пакета
            <td>опциональное
            <td>Определяется форматом пакета в соответствие с тегом типа
            <td>Содержит непосредственно заголовки и данные пакета, формат которых определяется стандартом и полностью соответствует тегу типа пакета.
    </tbody>
</table>

<h2>Свойства пакета</h2>

<p>
    Свойства пакета это битовое поле в формате BER, которое фиксирует использование и неиспользование определенных
    в стандарте свойств. Перечень этих свойств принадлежит стандарту и не может быть расширен без внесения информации
    в стандарт, т.к. влияет на возможности обеспечения обратной совместимости.
<p>
    Наличие каждого свойства кодируется единицей в соответствующем бите. Биты нумеруются от младшего к старшему.
    Все свойства по умолчанию считаются неактивными.
<p>
    Каждое активное свойство пакета может определять наличие соответствующих данных свойства формата определенного
    в стандарте. Таким образом если свойство N активно для данного пакета, то по стандарту может потребоваться наличие
    дополнительных данных в поле "данные свойств пакета". Данные свойств пакета кодируются по порядку для всех активных
    свойств начиная от наименьшего по идентификатору до наибольшего.

<h2>Данные свойств пакета</h2>
<p>
    В этом поле по порядку от наименьшего активного свойства до наибольшего кодируются данные предусмотренные стандартом
    для каждого свойства.

<h2>Данные пакета</h2>
<p>
    Данные пакета это дополнительные данные регламентированные стандартом соответствующего тега типа. Формат и длина
    таких данных не ограничены и определяются исходя из потребностей реализации.

<h2>Стандартные свойства пакета</h2>
<p>
    Номера свойств с 0 по 31 закреплены за свойствами определяемыми основным стандартом PPF. Номера начиная с 32 могут
    быть использованы при проектировании предметных пакетов, но использование этих номеров должно быть внесено
    в стандарт с целью избежания пересечений. Для закрытых форматов значение данных свойств может не расшифорвываться,
    но метод расчета длины данных этого свойства должен быть указан.

<h3>Бит 0. Наличие расширенных свойств</h3>
<p>Указывает на наличие (активно) или на отсутствие (не активно) расширенного описания свойств пакета.
<p>
    Расширенные свойства пакета это те же самые свойства, но записанные в другом формате. В данном разделе наличие
    свойства кодируется не битом среди общий свойств, а указанием номера свойства. При вычислении применяемых свойств
    пакета используется логическая операция ИЛИ, с помощью которой битовый флаги свойств объединяются со свойствами
    из расширенного описания. Формат записи следующий: сначала идет количество активных свойств перечисленных
    в расширенном виде в формате BER, а затем идут закодированные идентификаторы этих свойств в формате BER.
    Например: если мы хотим установить свойства 23, 45, 122, 32456, то в пакете они будут закодированы как BER(4),
    BER(23), BER(45), BER(32456).
<p>Порядок следования свойств в расширенном описании – от меньшего к большему.
<p>Данные свойства пакета:
<ol>
    <li>Количество расширенных свойств пакета.
    <li>Значения свойств пакета.
</ol>

<h3>Бит 1. Используется версионирование</h3>
<p>Указывает на то, что версия пакета отличается от первой версии и требует указания версии пакета в явном виде.
<p>Данные свойства пакета:
<ol>
    <li>Номер версии пакета. Здесь значение 0 кодирует версию 2 (если нумеровать версии пакетов с 1), 1 – версию 3 и т.д.
</ol>

<h3>Бит 2. Указан тег типа пакета</h3>
<p>
    Тег типа однозначно указывает что за пакет находится в потоке, т.к. все теги являются глобально уникальными и должны
    заноситься в общий реестр тегов. Теги от 0 до 63 закреплены за базовыми форматами пакетов и не могут использоваться
    для реализации предметно-ориентированых задач, они являются системными.
<p>Конкретное ПО может поддерживать любое подмножество тегов (форматов пакетов) на любом необходимом уровне.
<p>
    Тег типа пакета явно должен определять обязательный набор свойств использованных в формате пакета и перечень
    и формат данных пакета. Эти данные стандартизуются и вносятся в реестр известных тегов. Если формат пакета закрыт,
    то стандартизуется только то, что идентификатор тега занят, его свойства и данные пакета не определяются.
<p>Данные свойства пакета:
<ol>
    <li>Значение тега типа пакета.
</ol>

<h3>Бит 3. Длина данных пакета</h3>
<p>Указывает на то, что длина данных пакета указана явно в данных свойства.
<p>Данные свойства пакета:
<ol>
    <li>Длина данных пакета.
</ol>

<h3>Бит 4. Используется сегментирование</h3>
<p>Указывает на то, что пакет является лишь сегментом данных.
<p>Данные свойства пакета:
<ol>
    <li>Номер текущего сегмента.
    <li>Максимальный номер сегмента (0 – единственный сегмент).
</ol>

<h3>Бит 5. Используется адресация</h3>
<p>
    Указывает на то что пакет содержит один или несколько адресов/абонентов (например: адрес отправителя, адрес
    получателя, адреса промежуточных узлов, номер порта, номер устройства, ID процесса и т.д.). Смысл и допустимое
    количество адресов определяются стандартом конкретного пакета. Пример: в случае реализации протокола TCP/IPv4
    в одном пакете PPF адреса могут содержать последовательность: адрес отправителя, порт отправителя, адрес получателя,
    порт получателя.
<p>Данные свойства пакета:
<ol>
    <li>Количество адресов.
    <li>Абоненты (адреса).
</ol>

<h3>Бит 6. Используется защита целостности данных от повреждений при передаче</h3>
<p>
    Указывает на то, что данные и заголовок (warning) пакета защищены от повреждений контрольной суммой или т.п.
    Контрольная сумма должны подписывать все данные пакета и все заголовки за исключением самого значения контрольной
    суммы.
<p>Данные свойства пакета:
<ol>
    <li>Вид защиты данных пакета.
        <table class="table">
            <thead>
                <tr><th>Значение вида защиты целостности данных<th>Описание метода защиты
            </thead>
            <tbody>
                <tr><td>0<td>CRC-16
                <tr><td>1<td>...
            </tbody>
        </table>
    <li>Значение контрольной суммы или другой код проверки целостности данных.
</ol>

<h3>Бит 7. Используется штамп времени формирования пакета</h3>
<p>Указывает на то, что пакет промаркирован шатмпом времени формирования.
<p>Данные свойства пакета:
<ol>
    <li>Тип штампа времени.
        <table class="table">
            <thead>
                <tr><th>Значение типа штампа времени<th>Описание типа штампа времени
                <tr><td>0<td>Не регламентирован (определен вышестоящим протоколом).
                <tr><td>1<td>Unix timestamp
                <tr><td>2<td>...
            </thead>
        </table>
    <li>Значение метки времени.
</ol>

<h3>Бит 8. Используется известное представление данных</h3>
<p>Указывает на то, что данные пакета представлены в одном из предопределенных видов.
<p>Данные свойства пакета:
<ol>
    <li>Вид представления данных пакета.
    <table class="table">
        <thead>
            <tr><th>Значение вида представления данных<th>Вид представления
        </thead>
        <tbody>
            <tr><td>1<td>UTF-8 строка
            <tr><td>2<td>JSON
            <tr><td>3<td>XML
            <tr><td>4<td>...
        </tbody>
    </table>
</ol>

<h3>Бит 9. Используется кодирование/шифрование данных</h3>
<p>Указывает на то, что данные пакета закодированы/зашифрованы.
<p>Данные свойства пакета:
<ol>
    <li>Тип кодирования.
    <table class="table">
        <thead>
            <tr><th>Значение типа кодирования/шифрования<th>Метод кодирования
        </thead>
        <tbody>
            <tr><td>0<td>AES256
            <tr><td>1<td>...
        </tbody>
    </table>
</ol>

<h2>Версионирование пакетов</h2>
<p>
    Для версионирования применяется свойство "Версия пакета". При версионировании запрещается в новой версии пакета
    объявлять необязательными свойства пакета, которые были обязательными в предыдущей версии, так же запрещается
    убирать или заменять существующие в прошлой версии поля в данных пакета. Разрешается добавлять новые обязательные
    и опциональные свойства пакета, а так же дополнять формат данных пакета (только при условии обязательности свойства
    "Длина данных пакета" в предыдущей версии пакета).

<h2>Вложенность пакетов</h2>
<p>
    Стандарт так же определяет виды пакетов которые могут быть вложены внутрь другого пакета. Таким образом можно
    заворачивать один пакет в другой обеспечивая многослойную структуру пакетов. Например пакет вида "Шифрованные
    данные" может указывать на то, что внутри могут быть любые пакеты и можно выстроить иерархию вида: Пакет шифрованных
    данных - Шифрованные данные пакета с информацией или наоборот Данные пакета с информацией включают пакет шифрованных
    данных.

<p>&copy; 2015 <a href="http://acsl.mipt.ru">ЛПСУ</a>

</div>
</body>
</html>